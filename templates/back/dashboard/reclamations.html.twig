{% extends 'back.html.twig' %}

{% block title %}Liste des Réclamations - Hospismart{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
    /* Structure de la page */
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 25px;
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    /* FIX DES BOUTONS DE TRI (En haut à droite) */
    .header-actions {
        display: flex;
        align-items: center;
        gap: 12px; /* Espacement entre "Trier par" et les boutons */
    }

    .sort-group {
        display: flex;
        gap: 8px; /* Espacement entre les boutons eux-mêmes */
    }

    .btn-sort {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        padding: 8px 16px;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 10px;
        color: #475569;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.2s ease;
        text-decoration: none;
        white-space: nowrap;
    }

    .btn-sort:hover {
        background: #f1f5f9;
        border-color: #cbd5e1;
        transform: translateY(-1px);
    }

    .btn-sort i {
        font-size: 14px;
    }

    /* Barre de filtres */
    .filters-card {
        background: white;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 25px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    /* Tableau */
    .complaints-table-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        padding: 20px;
    }

    .custom-table { width: 100%; border-collapse: collapse; }
    .custom-table th { background: #f8fafc; padding: 15px; text-align: left; color: #64748b; font-weight: 600; font-size: 13px; border-bottom: 2px solid #edf2f7; }
    .custom-table td { padding: 15px; border-top: 1px solid #f1f5f9; vertical-align: middle; font-size: 14px; }

    /* Statuts */
    .status-badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 700;
        text-transform: uppercase;
    }
    .bg-traite { background: #dcfce7; color: #166534; }
    .bg-cours { background: #dbeafe; color: #1e40af; }
    .bg-attente { background: #fef3c7; color: #92400e; }

    /* Actions en fin de ligne */
    .btn-action-group { display: flex; gap: 8px; justify-content: flex-end; }
    .btn-circle {
        width: 34px; height: 34px;
        display: flex; align-items: center; justify-content: center;
        border-radius: 8px; transition: 0.3s;
    }
    .btn-view { background: #eff6ff; color: #2563eb; }
    .btn-edit { background: #fef3c7; color: #d97706; }
    .btn-delete { background: #fef2f2; color: #dc2626; }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-title">
        <h1 class="m-0 fw-bold" style="font-size: 24px;">
            <i class="fa-solid fa-headset text-primary me-2"></i>Réclamations
        </h1>
    </div>
    
    <div class="header-actions">
        <span class="text-muted fw-semibold">Trier par :</span>
        <div class="sort-group">
            <a href="#" class="btn-sort shadow-sm">
                <i class="fa-solid fa-calendar-days text-warning"></i> Date
            </a>
            <a href="#" class="btn-sort shadow-sm">
                <i class="fa-solid fa-user text-primary"></i> Patient
            </a>
        </div>
    </div>
</div>

<div class="filters-card">
    <form class="row g-3">
        <div class="col-md-4">
            <div class="input-group">
                <span class="input-group-text bg-white border-end-0 text-muted"><i class="fa-solid fa-magnifying-glass"></i></span>
                <input type="text" class="form-control border-start-0" placeholder="Rechercher...">
            </div>
        </div>
        <div class="col-md-2"><select class="form-select border-light bg-light"><option>Catégorie</option></select></div>
        <div class="col-md-2"><select class="form-select border-light bg-light"><option>Priorité</option></select></div>
        <div class="col-md-2"><select class="form-select border-light bg-light"><option>Statut</option></select></div>
        <div class="col-md-2">
            <button type="button" class="btn btn-primary w-100 shadow-sm">Chercher</button>
        </div>
    </form>
</div>

<div class="complaints-table-card">
    <div class="table-responsive">
        <table class="custom-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Motif / Titre</th>
                    <th>Patient</th>
                    <th>Priorité</th>
                    <th>Statut</th>
                    <th class="text-end">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for c in consultations %}
                <tr>
                    <td><span class="text-muted fw-bold">#{{ c.id }}</span></td>
                    <td>
                        <div class="fw-bold text-dark">{{ c.motif|slice(0, 35) }}...</div>
                        <small class="text-muted"><i class="fa-regular fa-clock me-1"></i>{{ c.dateHeure|date('d/m/Y') }}</small>
                    </td>
                    <td>
                        <div class="fw-bold">{{ c.patient.user.prenom }} {{ c.patient.user.nom }}</div>
                        <div class="small text-muted">{{ c.patient.user.email }}</div>
                    </td>
                    <td><span class="badge" style="background:#e0e7ff; color:#4338ca;">Normale</span></td>
                    <td>
                        {% if c.statut.value == 'terminee' %}
                            <span class="status-badge bg-traite">Traité</span>
                        {% elseif c.statut.value == 'en_cours' %}
                            <span class="status-badge bg-cours">En cours</span>
                        {% else %}
                            <span class="status-badge bg-attente">En attente</span>
                        {% endif %}
                    </td>
                    <td>
                        <div class="btn-action-group">
                            <a href="#" class="btn-circle btn-view"><i class="fa-solid fa-eye"></i></a>
                            <a href="#" class="btn-circle btn-edit"><i class="fa-solid fa-pen"></i></a>
                            <a href="#" class="btn-circle btn-delete"><i class="fa-solid fa-trash"></i></a>
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="text-center py-5 text-muted">Aucune réclamation.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}